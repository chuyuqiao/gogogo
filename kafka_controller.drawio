<mxfile host="app.diagrams.net" modified="2020-10-16T10:01:45.484Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.80 Safari/537.36" etag="6-yj0GuEta5F2XnTUPYz" version="13.8.0" type="github" pages="5">
  <diagram id="TySNi0Zyadw6SgvpFzOM" name="副本状态机">
    <mxGraphModel dx="1426" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="HMK-gUAQqBiherPMlkDH-0" />
        <mxCell id="HMK-gUAQqBiherPMlkDH-1" parent="HMK-gUAQqBiherPMlkDH-0" />
        <mxCell id="qehNRnXvlH6UV2NimaYm-15" value="" style="group;sketch=0;" parent="HMK-gUAQqBiherPMlkDH-1" vertex="1" connectable="0">
          <mxGeometry x="50" y="10" width="740" height="765" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-5" value="&lt;h1&gt;说明&lt;/h1&gt;&lt;p&gt;1、replicaId = brokerId&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1">
          <mxGeometry x="550" width="190" height="120" as="geometry" />
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-9" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-27" target="HMK-gUAQqBiherPMlkDH-27" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="625" y="695" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-27" value="OfflineReplica" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1">
          <mxGeometry x="565" y="535" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-28" value="" style="rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-9" target="HMK-gUAQqBiherPMlkDH-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-29" value="1、发送 StopReplica 请求给 Replica。&lt;br&gt;2、从 isr 中移除这个 Replica，并且发送 LeaderAndIsr &lt;br&gt;请求给这个 Partition 的其它 副本。&lt;br&gt;3、&lt;span style=&quot;font-size: 12px ; background-color: rgb(248 , 249 , 250)&quot;&gt;向所有 live broker 发送 UpdateMetada 请求。&lt;/span&gt;" style="edgeLabel;html=1;align=left;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-28" vertex="1" connectable="0">
          <mxGeometry x="0.0429" y="2" relative="1" as="geometry">
            <mxPoint x="-184" y="2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-30" value="ReplicaDeletionStarted" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#d6b656;fillColor=#fff2cc;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1">
          <mxGeometry x="560" y="200" width="130" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-31" value="" style="rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;fillColor=#fff2cc;strokeColor=#d6b656;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-27" target="HMK-gUAQqBiherPMlkDH-30" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-32" value="&lt;span style=&quot;text-align: left&quot;&gt;发送 StopReplica 请求给 Replica，并且设置&lt;br&gt;deletePartition == true&lt;br&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-31" vertex="1" connectable="0">
          <mxGeometry x="0.2833" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-6" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0;entryDx=0;entryDy=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-34" target="HMK-gUAQqBiherPMlkDH-27" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="415" y="490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-7" value="Replica 删除重试" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="qehNRnXvlH6UV2NimaYm-6" vertex="1" connectable="0">
          <mxGeometry x="-0.4674" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-34" value="ReplicaDeletionIneligible" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#b85450;fillColor=#f8cecc;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1">
          <mxGeometry x="370" y="375" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-35" value="" style="rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-30" target="HMK-gUAQqBiherPMlkDH-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-36" value="" style="edgeStyle=none;rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-30" target="HMK-gUAQqBiherPMlkDH-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-37" value="" style="edgeStyle=none;rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-30" target="HMK-gUAQqBiherPMlkDH-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-38" value="" style="edgeStyle=none;rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-30" target="HMK-gUAQqBiherPMlkDH-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-39" value="" style="edgeStyle=none;rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;fillColor=#f8cecc;strokeColor=#b85450;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-30" target="HMK-gUAQqBiherPMlkDH-34" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-3" value="Replica 删除失败后的状态" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-39" vertex="1" connectable="0">
          <mxGeometry x="-0.0368" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-40" value="ReplicaDeletionSuccessful" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#9673a6;fillColor=#e1d5e7;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1">
          <mxGeometry x="320" y="90" width="150" height="90" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-41" value="" style="edgeStyle=none;rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-30" target="HMK-gUAQqBiherPMlkDH-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-4" value="Replica 删除成功后的状态" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-41" vertex="1" connectable="0">
          <mxGeometry x="0.1261" y="-4" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-2" value="NonExistentReplica" style="ellipse;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1">
          <mxGeometry x="120" y="215" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-43" value="" style="edgeStyle=none;rounded=1;sketch=0;jumpStyle=none;orthogonalLoop=1;jettySize=auto;html=1;shadow=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fillColor=#f5f5f5;strokeColor=#666666;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-40" target="HMK-gUAQqBiherPMlkDH-2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="350" y="90" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-0" value="从 Partition Replica Assignment&lt;br&gt;缓存中移除这个 Replica" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-43" vertex="1" connectable="0">
          <mxGeometry x="0.0109" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-4" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;sketch=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-2" target="HMK-gUAQqBiherPMlkDH-3" edge="1">
          <mxGeometry y="305" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-20" value="&lt;span style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;1、发送 LeaderAndIsr&amp;nbsp; 请求给新创建的 Replica。&lt;/span&gt;&lt;br style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;&lt;span style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;2、向所有 live broker 发送 UpdateMetada 请求。&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-4" vertex="1" connectable="0">
          <mxGeometry x="-0.05" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-44" value="" style="group" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1" connectable="0">
          <mxGeometry y="395" width="240" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-3" value="NewReplica" style="ellipse;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;sketch=0;" parent="HMK-gUAQqBiherPMlkDH-44" vertex="1">
          <mxGeometry x="120" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-12" value="Replica 刚创建时的状态，只能做 follower" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=0;" parent="HMK-gUAQqBiherPMlkDH-44" vertex="1">
          <mxGeometry y="30" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-11" value="" style="endArrow=classic;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-27" target="HMK-gUAQqBiherPMlkDH-27" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="580" y="670" as="sourcePoint" />
            <mxPoint x="610" y="370" as="targetPoint" />
            <Array as="points">
              <mxPoint x="670" y="680" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-12" value="" style="group" parent="qehNRnXvlH6UV2NimaYm-15" vertex="1" connectable="0">
          <mxGeometry y="625" width="240" height="140" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-9" value="OnlineReplica" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-12" vertex="1">
          <mxGeometry x="120" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-16" value="添加到 AR 的状态，可做leader、follower" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=0;" parent="qehNRnXvlH6UV2NimaYm-12" vertex="1">
          <mxGeometry y="25" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-18" value="" style="endArrow=classic;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;rounded=1;jumpStyle=none;shadow=0;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="qehNRnXvlH6UV2NimaYm-12" source="HMK-gUAQqBiherPMlkDH-9" target="HMK-gUAQqBiherPMlkDH-9" edge="1">
          <mxGeometry y="-320" width="50" height="50" as="geometry">
            <mxPoint x="350" y="100" as="sourcePoint" />
            <mxPoint x="230" y="60" as="targetPoint" />
            <Array as="points">
              <mxPoint x="180" y="140" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-19" value="&lt;span style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;1、发送 LeaderAndIsr&amp;nbsp; 请求给新创建的 Replica。&lt;/span&gt;&lt;br style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;&lt;span style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;2、向所有 live broker 发送 UpdateMetada 请求。&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-18" vertex="1" connectable="0">
          <mxGeometry x="-0.2555" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-2" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0;entryDx=0;entryDy=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-34" target="HMK-gUAQqBiherPMlkDH-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="415" y="490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-13" value="" style="endArrow=classic;html=1;entryX=0;entryY=0.4;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-3" target="HMK-gUAQqBiherPMlkDH-27" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="560" y="620" as="sourcePoint" />
            <mxPoint x="610" y="570" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-10" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;sketch=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-3" target="HMK-gUAQqBiherPMlkDH-9" edge="1">
          <mxGeometry y="375" as="geometry" />
        </mxCell>
        <mxCell id="HMK-gUAQqBiherPMlkDH-21" value="&lt;span style=&quot;font-size: 12px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;如果需要的情况下，向这个 Partition &lt;br&gt;的AR添加这个新的 Replica&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="HMK-gUAQqBiherPMlkDH-10" vertex="1" connectable="0">
          <mxGeometry x="-0.25" y="-3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qehNRnXvlH6UV2NimaYm-14" value="" style="endArrow=classic;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0;exitY=1;exitDx=0;exitDy=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="qehNRnXvlH6UV2NimaYm-15" source="HMK-gUAQqBiherPMlkDH-27" target="HMK-gUAQqBiherPMlkDH-9" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="560" y="480" as="sourcePoint" />
            <mxPoint x="610" y="430" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="1MHAfUvT2UG18_nVS0-U" name="分区状态机">
    <mxGraphModel dx="1426" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="isVmadQrg0_nP7J6bVH2-0" />
        <mxCell id="isVmadQrg0_nP7J6bVH2-1" parent="isVmadQrg0_nP7J6bVH2-0" />
        <mxCell id="isVmadQrg0_nP7J6bVH2-4" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="isVmadQrg0_nP7J6bVH2-1" source="isVmadQrg0_nP7J6bVH2-2" target="isVmadQrg0_nP7J6bVH2-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-14" value="load assigned replicas from&lt;br&gt;ZK to controller cache" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="isVmadQrg0_nP7J6bVH2-4" vertex="1" connectable="0">
          <mxGeometry x="0.0333" y="36" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-6" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="isVmadQrg0_nP7J6bVH2-1" source="isVmadQrg0_nP7J6bVH2-3" target="isVmadQrg0_nP7J6bVH2-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="180" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-2" value="1、分配 replicas 中的第一个 replica &lt;br&gt;作为 leader，全部 live replicas 作为 isr，&lt;br&gt;并把 leader 和 isr 信息更新到 zk 中。&lt;br&gt;2、发送 LeaderAndIsr 请求给所有 live replica，&lt;br&gt;发送UpdateMetadata 给每个 alive 的Broker。" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="isVmadQrg0_nP7J6bVH2-6" vertex="1" connectable="0">
          <mxGeometry x="-0.5613" y="23" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-13" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="isVmadQrg0_nP7J6bVH2-1" source="isVmadQrg0_nP7J6bVH2-3" target="isVmadQrg0_nP7J6bVH2-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-7" value="nothing other than marking partition state as Offline" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="isVmadQrg0_nP7J6bVH2-13" vertex="1" connectable="0">
          <mxGeometry x="-0.1189" y="4" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-8" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="isVmadQrg0_nP7J6bVH2-1" source="isVmadQrg0_nP7J6bVH2-5" target="isVmadQrg0_nP7J6bVH2-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-8" value="nothing other than marking partition state as Offline" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="isVmadQrg0_nP7J6bVH2-8" vertex="1" connectable="0">
          <mxGeometry x="-0.3067" y="12" relative="1" as="geometry">
            <mxPoint x="36" y="-18" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-9" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="isVmadQrg0_nP7J6bVH2-1" source="isVmadQrg0_nP7J6bVH2-7" target="isVmadQrg0_nP7J6bVH2-2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="670" y="130" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-9" value="nothing other than marking partition state as Offline" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="isVmadQrg0_nP7J6bVH2-9" vertex="1" connectable="0">
          <mxGeometry x="-0.4" y="46" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-11" value="" style="group" parent="isVmadQrg0_nP7J6bVH2-1" vertex="1" connectable="0">
          <mxGeometry x="355" y="90" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-2" value="NonExistentPartition" style="ellipse;whiteSpace=wrap;html=1;sketch=0;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="isVmadQrg0_nP7J6bVH2-11" vertex="1">
          <mxGeometry x="15" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-10" value="Partition 不存在，或者曾经存在现在已经删除。" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;sketch=0;" parent="isVmadQrg0_nP7J6bVH2-11" vertex="1">
          <mxGeometry y="80" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-1" value="" style="group" parent="isVmadQrg0_nP7J6bVH2-1" vertex="1" connectable="0">
          <mxGeometry x="10" y="240" width="230" height="80" as="geometry" />
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-3" value="NewPartition" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;sketch=0;" parent="wm_oVBO_ErBg2a_TBDjJ-1" vertex="1">
          <mxGeometry x="110" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-0" value="Partition 刚创建，有replicas，但还没有 leader 和 isr。" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="wm_oVBO_ErBg2a_TBDjJ-1" vertex="1">
          <mxGeometry y="20" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-4" value="" style="group" parent="isVmadQrg0_nP7J6bVH2-1" vertex="1" connectable="0">
          <mxGeometry x="370" y="400" width="120" height="130" as="geometry" />
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-5" value="OnlinePartition" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#82b366;fillColor=#d5e8d4;sketch=0;" parent="wm_oVBO_ErBg2a_TBDjJ-4" vertex="1">
          <mxGeometry width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-3" value="Partition 的 leader 已经选举出来" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="wm_oVBO_ErBg2a_TBDjJ-4" vertex="1">
          <mxGeometry y="80" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-5" value="" style="endArrow=classic;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=1;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="wm_oVBO_ErBg2a_TBDjJ-4" source="isVmadQrg0_nP7J6bVH2-5" target="isVmadQrg0_nP7J6bVH2-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="270" y="70" as="sourcePoint" />
            <mxPoint x="320" y="20" as="targetPoint" />
            <Array as="points">
              <mxPoint x="60" y="270" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-6" value="1、为这个 partition 选举新的 leader 和 isr，所有&lt;br&gt;live replica 来接收 LeaderAndIsr 请求，并把&lt;br&gt;leader 和 isr 信息更新到 zk 上。&lt;br&gt;2、发送 LeaderAndIsr 请求给所有 live replica，&lt;br&gt;发送UpdateMetadata 给每个 alive 的Broker。" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="wm_oVBO_ErBg2a_TBDjJ-5" vertex="1" connectable="0">
          <mxGeometry x="-0.4626" y="14" relative="1" as="geometry">
            <mxPoint x="5.88" y="25.970000000000002" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-11" value="" style="group" parent="isVmadQrg0_nP7J6bVH2-1" vertex="1" connectable="0">
          <mxGeometry x="610" y="240" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="isVmadQrg0_nP7J6bVH2-7" value="OfflinePartition" style="ellipse;whiteSpace=wrap;html=1;strokeColor=#9673a6;fillColor=#e1d5e7;sketch=0;" parent="wm_oVBO_ErBg2a_TBDjJ-11" vertex="1">
          <mxGeometry width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-10" value="Partition 的&lt;br&gt;leader 挂了" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="wm_oVBO_ErBg2a_TBDjJ-11" vertex="1">
          <mxGeometry x="120" y="25" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-12" value="" style="endArrow=classic;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;curved=1;" parent="isVmadQrg0_nP7J6bVH2-1" source="isVmadQrg0_nP7J6bVH2-7" target="isVmadQrg0_nP7J6bVH2-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="650" y="370" as="sourcePoint" />
            <mxPoint x="700" y="320" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wm_oVBO_ErBg2a_TBDjJ-13" value="1、为这个 partition 选举新的 leader 和 isr，所有&lt;br&gt;live replica 来接收 LeaderAndIsr 请求，并把&lt;br&gt;leader 和 isr 信息更新到 zk 上。&lt;br&gt;2、发送 LeaderAndIsr 请求给所有 live replica，&lt;br&gt;发送UpdateMetadata 给每个 alive 的Broker。" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="wm_oVBO_ErBg2a_TBDjJ-12" vertex="1" connectable="0">
          <mxGeometry x="0.1517" y="33" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="QrTFE32Dahz5huJ2j8bn" name="副本迁移">
    <mxGraphModel dx="1426" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="LZpg6AHhA8l05rzdTZTv-0" />
        <mxCell id="LZpg6AHhA8l05rzdTZTv-1" parent="LZpg6AHhA8l05rzdTZTv-0" />
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-21" value="" style="group" vertex="1" connectable="0" parent="LZpg6AHhA8l05rzdTZTv-1">
          <mxGeometry x="10" y="50" width="788.75" height="810" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-13" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="XBBJrYsHMT_xYTvtQ7yU-21" target="bZn0xBxZknq9e5iWEY-U-12" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="282.5" y="290" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-14" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="bZn0xBxZknq9e5iWEY-U-13" vertex="1" connectable="0">
          <mxGeometry x="-0.05" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-6" value="&lt;pre style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;helvetica&amp;#34;&quot;&gt;该 partition 是否&lt;/span&gt;&lt;/pre&gt;&lt;pre style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;helvetica&amp;#34;&quot;&gt;正在迁移&lt;/span&gt;&lt;/pre&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" parent="XBBJrYsHMT_xYTvtQ7yU-21" vertex="1">
          <mxGeometry x="192.5" y="210" width="180" height="80" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-8" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-7" target="bZn0xBxZknq9e5iWEY-U-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="282.5" y="210" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-7" value="开始" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;" parent="XBBJrYsHMT_xYTvtQ7yU-21" vertex="1">
          <mxGeometry x="232.5" y="70" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-9" value="结束" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="XBBJrYsHMT_xYTvtQ7yU-21" vertex="1">
          <mxGeometry x="50" y="750" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-10" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;edgeStyle=orthogonalEdgeStyle;" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-6" target="bZn0xBxZknq9e5iWEY-U-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint y="250" />
              <mxPoint y="790" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-11" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="bZn0xBxZknq9e5iWEY-U-10" vertex="1" connectable="0">
          <mxGeometry x="-0.2333" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-12" value="该 partition 是否&lt;br&gt;标记为删除" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" parent="XBBJrYsHMT_xYTvtQ7yU-21" vertex="1">
          <mxGeometry x="215" y="390" width="135" height="100" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-17" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-6" target="bZn0xBxZknq9e5iWEY-U-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-21" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-22" target="bZn0xBxZknq9e5iWEY-U-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="44.375" y="470" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-22" value="&lt;span&gt;将该 partition 从 zk 的迁移记录中删除，结果更新到 zk 中&lt;/span&gt;" style="whiteSpace=wrap;html=1;strokeWidth=2;" parent="XBBJrYsHMT_xYTvtQ7yU-21" vertex="1">
          <mxGeometry x="40" y="410" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-18" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-12" target="bZn0xBxZknq9e5iWEY-U-22" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="95" y="500" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-20" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="bZn0xBxZknq9e5iWEY-U-18" vertex="1" connectable="0">
          <mxGeometry x="0.0733" relative="1" as="geometry">
            <mxPoint y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-24" value="初始化要迁移的 partition" style="whiteSpace=wrap;html=1;strokeWidth=2;" parent="XBBJrYsHMT_xYTvtQ7yU-21" vertex="1">
          <mxGeometry x="210" y="570" width="145" height="60" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-25" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-12" target="bZn0xBxZknq9e5iWEY-U-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-0" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="bZn0xBxZknq9e5iWEY-U-25">
          <mxGeometry x="-0.15" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-26" target="bZn0xBxZknq9e5iWEY-U-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="665" y="600" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-1" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="bZn0xBxZknq9e5iWEY-U-29">
          <mxGeometry x="-0.7427" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-26" value="该 partition 的副本&lt;br&gt;是否存在" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" parent="XBBJrYsHMT_xYTvtQ7yU-21" vertex="1">
          <mxGeometry x="430" y="555" width="145" height="90" as="geometry" />
        </mxCell>
        <mxCell id="bZn0xBxZknq9e5iWEY-U-27" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-24" target="bZn0xBxZknq9e5iWEY-U-26" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-2" value="开始迁移操作，新建的副本开始同步数据。如果满足 isr 条件，该副本会加入到 isr 中，再通过监听 isr 的情况，判断是否迁移完成。" style="whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="XBBJrYsHMT_xYTvtQ7yU-21">
          <mxGeometry x="408.75" y="410" width="187.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-3" value="" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="bZn0xBxZknq9e5iWEY-U-26" target="XBBJrYsHMT_xYTvtQ7yU-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-4" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="XBBJrYsHMT_xYTvtQ7yU-3">
          <mxGeometry x="-0.2211" y="-1" relative="1" as="geometry">
            <mxPoint x="1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-5" value="判断该 partition &lt;br&gt;是否迁移完成&lt;br&gt;（新副本&lt;br&gt;是否在 isr 中）" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="XBBJrYsHMT_xYTvtQ7yU-21">
          <mxGeometry x="427.5" y="240" width="147.5" height="100" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-6" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="XBBJrYsHMT_xYTvtQ7yU-2" target="XBBJrYsHMT_xYTvtQ7yU-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-7" value="迁移完成后，下线旧的副本，将新的副本信息更新到缓存并更新 zk 中副本迁移的 partition 列表。&amp;nbsp;" style="whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="XBBJrYsHMT_xYTvtQ7yU-21">
          <mxGeometry x="421.87" y="110" width="158.75" height="60" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-8" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="XBBJrYsHMT_xYTvtQ7yU-5" target="XBBJrYsHMT_xYTvtQ7yU-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-9" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="XBBJrYsHMT_xYTvtQ7yU-8">
          <mxGeometry x="0.1091" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-12" value="完成" style="whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="XBBJrYsHMT_xYTvtQ7yU-21">
          <mxGeometry x="442.505" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-13" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="XBBJrYsHMT_xYTvtQ7yU-7" target="XBBJrYsHMT_xYTvtQ7yU-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-14" value="向新的 replica 再次发送 LeaderAndIsr 请求，新副本开始数据同步" style="whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="XBBJrYsHMT_xYTvtQ7yU-21">
          <mxGeometry x="668.75" y="260" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-15" value="" style="edgeStyle=none;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="XBBJrYsHMT_xYTvtQ7yU-21" source="XBBJrYsHMT_xYTvtQ7yU-5" target="XBBJrYsHMT_xYTvtQ7yU-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XBBJrYsHMT_xYTvtQ7yU-16" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="XBBJrYsHMT_xYTvtQ7yU-15">
          <mxGeometry x="-0.424" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="eewKVvYhqFU1bjK8aRXS" name="Broker 上下线">
    <mxGraphModel dx="1426" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="qWlImmMHi30EqFsguoFH-0" />
        <mxCell id="qWlImmMHi30EqFsguoFH-1" parent="qWlImmMHi30EqFsguoFH-0" />
        <mxCell id="qWlImmMHi30EqFsguoFH-3" value="/brokers/ids&lt;br&gt;/controller" style="rounded=0;whiteSpace=wrap;html=1;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="440" y="40" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-0" value="&lt;h1&gt;说明&lt;/h1&gt;&lt;p&gt;1、只有 controller 才会处理 broker 的上下线事件。&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="120" y="40" width="190" height="120" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-1" value="&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;#34;menlo&amp;#34;&quot;&gt;ControllerChannelManager&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="600" y="180" width="190" height="1100" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-4" value="&lt;pre style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;#34;menlo&amp;#34;&quot;&gt;&lt;br&gt;&lt;/pre&gt;" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-1">
          <mxGeometry x="90" y="80" width="10" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-37" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-1">
          <mxGeometry x="90" y="530" width="10" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-2" value="&lt;pre style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;#34;menlo&amp;#34;&quot;&gt;BrokerChangeHandler&lt;/pre&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="360" y="180" width="190" height="1100" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-3" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-2">
          <mxGeometry x="90" y="80" width="10" height="400" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-35" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-2">
          <mxGeometry x="90" y="530" width="10" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-5" value="&lt;pre&gt;&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;addBroker&lt;/pre&gt;&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;exitX=0.7;exitY=0.013;exitDx=0;exitDy=0;exitPerimeter=0;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-4" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-3">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="630" y="260" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-16" value="&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;#34;menlo&amp;#34;&quot;&gt;KafkaController&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="840" y="180" width="190" height="1100" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-20" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry x="90" y="180" width="10" height="300" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-21" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;sendUpdateMetadataRequest&lt;/pre&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;align=left;spacingLeft=2;endArrow=block;rounded=0;entryX=1;entryY=0;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-20" parent="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="95" y="160" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="120" y="160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-39" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry x="90" y="610" width="10" height="330" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-58" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;triggerOnlinePartitionStateChange&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;sketch=1;" edge="1" parent="CRFFkOpo41qg07ba1Y22-16" target="CRFFkOpo41qg07ba1Y22-26">
          <mxGeometry width="60" relative="1" as="geometry">
            <mxPoint x="100" y="740" as="sourcePoint" />
            <mxPoint x="160" y="740" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-60" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry x="90" y="1020" width="10" height="40" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-61" value="self call" style="edgeStyle=orthogonalEdgeStyle;html=1;align=left;spacingLeft=2;endArrow=block;rounded=0;entryX=1;entryY=0;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-60" parent="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="95" y="1000" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="120" y="1000" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-19" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;onBrokerStartup&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;exitX=0.4;exitY=1.013;exitDx=0;exitDy=0;exitPerimeter=0;sketch=1;" edge="1" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-4">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="699" y="340" as="sourcePoint" />
            <mxPoint x="930" y="341.03999999999996" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-22" value="&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;#34;menlo&amp;#34;&quot;&gt;ReplicaStateMachine&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="1170" y="180" width="190" height="1100" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-28" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-22">
          <mxGeometry x="90" y="260" width="10" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-54" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-22">
          <mxGeometry x="90" y="860" width="10" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-59" value="return" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;sketch=1;" edge="1" parent="CRFFkOpo41qg07ba1Y22-22" target="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="90" y="940" as="sourcePoint" />
            <mxPoint x="10" y="940" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-26" value="&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;#34;menlo&amp;#34;&quot;&gt;PartitionStateMachine&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="1460" y="180" width="190" height="1100" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-30" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-26">
          <mxGeometry x="90" y="400" width="10" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-41" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;sketch=1;" vertex="1" parent="CRFFkOpo41qg07ba1Y22-26">
          <mxGeometry x="90" y="610" width="10" height="190" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-29" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;handleStateChanges&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-28" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1200" y="500" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1110" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-31" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;triggerOnlinePartitionStateChange&lt;/pre&gt;" style="html=1;verticalAlign=bottom;endArrow=block;entryX=0;entryY=0;sketch=1;exitX=1;exitY=0.733;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" target="CRFFkOpo41qg07ba1Y22-30" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-20">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="950" y="580" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-32" value="return" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;sketch=1;" edge="1" parent="qWlImmMHi30EqFsguoFH-1" target="CRFFkOpo41qg07ba1Y22-2">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1480" y="656" as="targetPoint" />
            <mxPoint x="930" y="656" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-33" value="" style="shape=umlLifeline;participant=umlActor;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;verticalAlign=top;spacingTop=36;outlineConnect=0;sketch=1;" vertex="1" parent="qWlImmMHi30EqFsguoFH-1">
          <mxGeometry x="120" y="180" width="20" height="1100" as="geometry" />
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-34" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;BrokerChange 上线&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;startFill=1;endArrow=block;startSize=8;sketch=1;" edge="1" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-33">
          <mxGeometry width="60" relative="1" as="geometry">
            <mxPoint x="670" y="340" as="sourcePoint" />
            <mxPoint x="455" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-36" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;BrokerChange 下线&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;entryX=0.6;entryY=-0.025;entryDx=0;entryDy=0;entryPerimeter=0;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-35" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-33">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="390" y="710" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-38" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;removeBroker&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-1" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-35">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="630" y="710" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="590" y="710" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-40" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;onBrokerFailure&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-39" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="870" y="790" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-42" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;handleStateChanges&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-41" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1490" y="790" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-47" value="return" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;exitX=0;exitY=0.95;sketch=1;" edge="1" parent="qWlImmMHi30EqFsguoFH-1" target="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1490" y="870" as="targetPoint" />
            <mxPoint x="1560" y="870" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-53" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;triggerOnlinePartitionStateChange&lt;/pre&gt;" style="html=1;verticalAlign=bottom;endArrow=block;sketch=1;" edge="1" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-16" target="CRFFkOpo41qg07ba1Y22-26">
          <mxGeometry width="80" relative="1" as="geometry">
            <mxPoint x="1010" y="950" as="sourcePoint" />
            <mxPoint x="1090" y="950" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-50" value="return" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;exitX=0.1;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;sketch=1;" edge="1" source="CRFFkOpo41qg07ba1Y22-41" parent="qWlImmMHi30EqFsguoFH-1" target="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1190" y="976" as="targetPoint" />
            <mxPoint x="1550" y="976" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-55" value="&lt;pre style=&quot;font-family: &amp;#34;menlo&amp;#34;&quot;&gt;handleStateChanges&lt;/pre&gt;" style="html=1;verticalAlign=bottom;startArrow=oval;endArrow=block;startSize=8;sketch=1;" edge="1" target="CRFFkOpo41qg07ba1Y22-54" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1200" y="1040" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-62" value="return" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;exitX=0.4;exitY=0.988;exitDx=0;exitDy=0;exitPerimeter=0;sketch=1;" edge="1" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-28" target="CRFFkOpo41qg07ba1Y22-16">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1210" y="560" as="sourcePoint" />
            <mxPoint x="1010" y="630" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CRFFkOpo41qg07ba1Y22-63" value="return" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;entryX=0.9;entryY=0.993;entryDx=0;entryDy=0;entryPerimeter=0;sketch=1;" edge="1" parent="qWlImmMHi30EqFsguoFH-1" source="CRFFkOpo41qg07ba1Y22-26" target="CRFFkOpo41qg07ba1Y22-20">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="920" y="670" as="sourcePoint" />
            <mxPoint x="840" y="670" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="cKII1xWul_C9JO8oNJGn" name="LeaderAndIsr 请求">
    <mxGraphModel dx="1426" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="oHa9R7XRsvDBFl1aMqYG-0" />
        <mxCell id="oHa9R7XRsvDBFl1aMqYG-1" parent="oHa9R7XRsvDBFl1aMqYG-0" />
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
